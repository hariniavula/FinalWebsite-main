<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    #vis.vega-embed {
      width: 100%;
      display: flex;
    }

    #vis.vega-embed details,
    #vis.vega-embed details summary {
      position: relative;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega@6"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-lite@6.1.0"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-embed@7"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"url": "https://cdn.jsdelivr.net/npm/vega-datasets@v1.29.0/data/us-10m.json", "format": {"feature": "states", "type": "topojson"}}, "mark": {"type": "geoshape", "stroke": "white"}, "encoding": {"color": {"condition": {"test": "(!isDefined(RegionSelector_Region) || RegionSelector_Region === null) || datum.Region == RegionSelector_Region", "field": "avg_purchase", "scale": {"scheme": "blues"}, "title": "Average purchase (USD)", "type": "quantitative"}, "value": "lightgray"}, "stroke": {"condition": {"param": "param_96269e0386517956", "value": "black"}, "value": "white"}, "strokeWidth": {"condition": {"param": "param_96269e0386517956", "value": 1}, "value": 0.5}, "tooltip": [{"field": "Location", "title": "State", "type": "nominal"}, {"field": "avg_purchase", "format": ".2f", "title": "Average purchase", "type": "quantitative"}, {"field": "total_customers", "title": "Total customers", "type": "quantitative"}, {"field": "Region", "type": "nominal"}, {"field": "transaction_count", "title": "Transaction count", "type": "quantitative"}]}, "height": 450, "params": [{"name": "RegionSelector", "select": {"type": "point", "fields": ["Region"]}, "bind": {"input": "select", "options": [null, "Midwest", "Northeast", "South", "West"], "labels": ["All", "Midwest", "Northeast", "South", "West"], "name": "Filter by Region: "}}, {"name": "param_96269e0386517956", "select": {"type": "point", "clear": "mouseout", "fields": ["id"], "on": "mouseover"}}], "projection": {"type": "albersUsa"}, "title": "Average Purchase Amount in each State", "transform": [{"lookup": "id", "from": {"data": {"name": "data-71b9a03c7ebb1f4b39ede7fe029895fc"}, "key": "state_id", "fields": ["Location", "avg_purchase", "total_customers", "transaction_count", "Region"]}}], "width": 600, "$schema": "https://vega.github.io/schema/vega-lite/v6.1.0.json", "datasets": {"data-71b9a03c7ebb1f4b39ede7fe029895fc": [{"Location": "Alabama", "avg_purchase": 59.1123595505618, "total_customers": 89, "transaction_count": 89, "state_id": 1, "Region": "South"}, {"Location": "Alaska", "avg_purchase": 67.59722222222223, "total_customers": 72, "transaction_count": 72, "state_id": 2, "Region": "West"}, {"Location": "Arizona", "avg_purchase": 66.55384615384615, "total_customers": 65, "transaction_count": 65, "state_id": 4, "Region": "West"}, {"Location": "Arkansas", "avg_purchase": 61.11392405063291, "total_customers": 79, "transaction_count": 79, "state_id": 5, "Region": "South"}, {"Location": "California", "avg_purchase": 59.0, "total_customers": 95, "transaction_count": 95, "state_id": 6, "Region": "West"}, {"Location": "Colorado", "avg_purchase": 56.29333333333334, "total_customers": 75, "transaction_count": 75, "state_id": 8, "Region": "West"}, {"Location": "Connecticut", "avg_purchase": 54.17948717948718, "total_customers": 78, "transaction_count": 78, "state_id": 9, "Region": "Northeast"}, {"Location": "Delaware", "avg_purchase": 55.325581395348834, "total_customers": 86, "transaction_count": 86, "state_id": 10, "Region": "South"}, {"Location": "Florida", "avg_purchase": 55.85294117647059, "total_customers": 68, "transaction_count": 68, "state_id": 12, "Region": "South"}, {"Location": "Georgia", "avg_purchase": 58.79746835443038, "total_customers": 79, "transaction_count": 79, "state_id": 13, "Region": "South"}, {"Location": "Hawaii", "avg_purchase": 57.723076923076924, "total_customers": 65, "transaction_count": 65, "state_id": 15, "Region": "West"}, {"Location": "Idaho", "avg_purchase": 60.075268817204304, "total_customers": 93, "transaction_count": 93, "state_id": 16, "Region": "West"}, {"Location": "Illinois", "avg_purchase": 61.05434782608695, "total_customers": 92, "transaction_count": 92, "state_id": 17, "Region": "Midwest"}, {"Location": "Indiana", "avg_purchase": 58.924050632911396, "total_customers": 79, "transaction_count": 79, "state_id": 18, "Region": "Midwest"}, {"Location": "Iowa", "avg_purchase": 60.88405797101449, "total_customers": 69, "transaction_count": 69, "state_id": 19, "Region": "Midwest"}, {"Location": "Kansas", "avg_purchase": 54.55555555555556, "total_customers": 63, "transaction_count": 63, "state_id": 20, "Region": "Midwest"}, {"Location": "Kentucky", "avg_purchase": 55.721518987341774, "total_customers": 79, "transaction_count": 79, "state_id": 21, "Region": "South"}, {"Location": "Louisiana", "avg_purchase": 57.714285714285715, "total_customers": 84, "transaction_count": 84, "state_id": 22, "Region": "South"}, {"Location": "Maine", "avg_purchase": 56.98701298701299, "total_customers": 77, "transaction_count": 77, "state_id": 23, "Region": "Northeast"}, {"Location": "Maryland", "avg_purchase": 55.75581395348837, "total_customers": 86, "transaction_count": 86, "state_id": 24, "Region": "South"}, {"Location": "Massachusetts", "avg_purchase": 60.888888888888886, "total_customers": 72, "transaction_count": 72, "state_id": 25, "Region": "Northeast"}, {"Location": "Michigan", "avg_purchase": 62.0958904109589, "total_customers": 73, "transaction_count": 73, "state_id": 26, "Region": "Midwest"}, {"Location": "Minnesota", "avg_purchase": 56.55681818181818, "total_customers": 88, "transaction_count": 88, "state_id": 27, "Region": "Midwest"}, {"Location": "Mississippi", "avg_purchase": 61.0375, "total_customers": 80, "transaction_count": 80, "state_id": 28, "Region": "South"}, {"Location": "Missouri", "avg_purchase": 57.91358024691358, "total_customers": 81, "transaction_count": 81, "state_id": 29, "Region": "Midwest"}, {"Location": "Montana", "avg_purchase": 60.25, "total_customers": 96, "transaction_count": 96, "state_id": 30, "Region": "West"}, {"Location": "Nebraska", "avg_purchase": 59.44827586206897, "total_customers": 87, "transaction_count": 87, "state_id": 31, "Region": "Midwest"}, {"Location": "Nevada", "avg_purchase": 63.37931034482759, "total_customers": 87, "transaction_count": 87, "state_id": 32, "Region": "West"}, {"Location": "New Hampshire", "avg_purchase": 59.42253521126761, "total_customers": 71, "transaction_count": 71, "state_id": 33, "Region": "Northeast"}, {"Location": "New Jersey", "avg_purchase": 56.74626865671642, "total_customers": 67, "transaction_count": 67, "state_id": 34, "Region": "Northeast"}, {"Location": "New Mexico", "avg_purchase": 61.901234567901234, "total_customers": 81, "transaction_count": 81, "state_id": 35, "Region": "West"}, {"Location": "New York", "avg_purchase": 60.42528735632184, "total_customers": 87, "transaction_count": 87, "state_id": 36, "Region": "Northeast"}, {"Location": "North Carolina", "avg_purchase": 60.794871794871796, "total_customers": 78, "transaction_count": 78, "state_id": 37, "Region": "South"}, {"Location": "North Dakota", "avg_purchase": 62.89156626506024, "total_customers": 83, "transaction_count": 83, "state_id": 38, "Region": "Midwest"}, {"Location": "Ohio", "avg_purchase": 60.37662337662338, "total_customers": 77, "transaction_count": 77, "state_id": 39, "Region": "Midwest"}, {"Location": "Oklahoma", "avg_purchase": 58.346666666666664, "total_customers": 75, "transaction_count": 75, "state_id": 40, "Region": "South"}, {"Location": "Oregon", "avg_purchase": 57.33783783783784, "total_customers": 74, "transaction_count": 74, "state_id": 41, "Region": "West"}, {"Location": "Pennsylvania", "avg_purchase": 66.56756756756756, "total_customers": 74, "transaction_count": 74, "state_id": 42, "Region": "Northeast"}, {"Location": "Rhode Island", "avg_purchase": 61.44444444444444, "total_customers": 63, "transaction_count": 63, "state_id": 44, "Region": "Northeast"}, {"Location": "South Carolina", "avg_purchase": 58.4078947368421, "total_customers": 76, "transaction_count": 76, "state_id": 45, "Region": "South"}, {"Location": "South Dakota", "avg_purchase": 60.51428571428571, "total_customers": 70, "transaction_count": 70, "state_id": 46, "Region": "Midwest"}, {"Location": "Tennessee", "avg_purchase": 61.97402597402598, "total_customers": 77, "transaction_count": 77, "state_id": 47, "Region": "South"}, {"Location": "Texas", "avg_purchase": 61.1948051948052, "total_customers": 77, "transaction_count": 77, "state_id": 48, "Region": "South"}, {"Location": "Utah", "avg_purchase": 62.57746478873239, "total_customers": 71, "transaction_count": 71, "state_id": 49, "Region": "West"}, {"Location": "Vermont", "avg_purchase": 57.1764705882353, "total_customers": 85, "transaction_count": 85, "state_id": 50, "Region": "Northeast"}, {"Location": "Virginia", "avg_purchase": 62.883116883116884, "total_customers": 77, "transaction_count": 77, "state_id": 51, "Region": "South"}, {"Location": "Washington", "avg_purchase": 63.32876712328767, "total_customers": 73, "transaction_count": 73, "state_id": 53, "Region": "West"}, {"Location": "West Virginia", "avg_purchase": 63.876543209876544, "total_customers": 81, "transaction_count": 81, "state_id": 54, "Region": "South"}, {"Location": "Wisconsin", "avg_purchase": 55.946666666666665, "total_customers": 75, "transaction_count": 75, "state_id": 55, "Region": "Midwest"}, {"Location": "Wyoming", "avg_purchase": 60.690140845070424, "total_customers": 71, "transaction_count": 71, "state_id": 56, "Region": "West"}]}};
      var embedOpt = {"mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>